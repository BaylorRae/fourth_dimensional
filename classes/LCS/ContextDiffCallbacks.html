<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>LCS::ContextDiffCallbacks</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="LCS::ContextDiffCallbacks">

  
    
    <meta name="description" content="This will produce a compound array of contextual diff change objects. Each element in the diffs array is a “hunk” array, where each element in each “hunk” array is a single change.">
    <meta property="og:description" content="This will produce a compound array of contextual diff change objects. Each element in the diffs array is a “hunk” array, where each element in each “hunk” array is a single change.">
  

    <meta name="keywords" content="LCS::ContextDiffCallbacks class">
  
    <meta name="keywords" content="discard_a, discard_b, change">
  
</head>

<body>
    <div class="banner">
        
        <h1>
            <span class="type">Class</span>
            LCS::ContextDiffCallbacks
            
                <span class="parent">&lt;
                    
                    Diff::LCS::DiffCallbacks
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/vendor/bundle/ruby/2_6_0/gems/diff-lcs-1_3/lib/diff/lcs/callbacks_rb.html">vendor/bundle/ruby/2.6.0/gems/diff-lcs-1.3/lib/diff/lcs/callbacks.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>This will produce a compound array of contextual diff change objects. Each element in the diffs array is a “hunk” array, where each element in each “hunk” array is a single change. Each change is a Diff::LCS::ContextChange that contains both the old index and new index values for the change. The “hunk” provides the full context for the changes. Both old and new objects will be presented for changed objects. <code>nil</code> will be substituted for a discarded object.</p>

<pre><code>seq1 = %w(a b c e h j l m n p)
seq2 = %w(b c d e f j k l m r s t)

diffs = Diff::LCS.diff(seq1, seq2, Diff::LCS::ContextDiffCallbacks)
  # This example shows a simplified array format.
  # [ [ [ &#39;-&#39;, [  0, &#39;a&#39; ], [  0, nil ] ] ],   # 1
  #   [ [ &#39;+&#39;, [  3, nil ], [  2, &#39;d&#39; ] ] ],   # 2
  #   [ [ &#39;-&#39;, [  4, &#39;h&#39; ], [  4, nil ] ],     # 3
  #     [ &#39;+&#39;, [  5, nil ], [  4, &#39;f&#39; ] ] ],
  #   [ [ &#39;+&#39;, [  6, nil ], [  6, &#39;k&#39; ] ] ],   # 4
  #   [ [ &#39;-&#39;, [  8, &#39;n&#39; ], [  9, nil ] ],     # 5
  #     [ &#39;+&#39;, [  9, nil ], [  9, &#39;r&#39; ] ],
  #     [ &#39;-&#39;, [  9, &#39;p&#39; ], [ 10, nil ] ],
  #     [ &#39;+&#39;, [ 10, nil ], [ 10, &#39;s&#39; ] ],
  #     [ &#39;+&#39;, [ 10, nil ], [ 11, &#39;t&#39; ] ] ] ]
</code></pre>

<p>The five hunks shown are comprised of individual changes; if there is a related set of changes, they are still shown individually.</p>

<p>This callback can also be used with <a href="../LCS.html#method-i-sdiff"><code>Diff::LCS#sdiff</code></a>, which will produce results like:</p>

<pre><code>diffs = Diff::LCS.sdiff(seq1, seq2, Diff::LCS::ContextCallbacks)
  # This example shows a simplified array format.
  # [ [ [ &quot;-&quot;, [  0, &quot;a&quot; ], [  0, nil ] ] ],  # 1
  #   [ [ &quot;+&quot;, [  3, nil ], [  2, &quot;d&quot; ] ] ],  # 2
  #   [ [ &quot;!&quot;, [  4, &quot;h&quot; ], [  4, &quot;f&quot; ] ] ],  # 3
  #   [ [ &quot;+&quot;, [  6, nil ], [  6, &quot;k&quot; ] ] ],  # 4
  #   [ [ &quot;!&quot;, [  8, &quot;n&quot; ], [  9, &quot;r&quot; ] ],    # 5
  #     [ &quot;!&quot;, [  9, &quot;p&quot; ], [ 10, &quot;s&quot; ] ],
  #     [ &quot;+&quot;, [ 10, nil ], [ 11, &quot;t&quot; ] ] ] ]
</code></pre>

<p>The five hunks are still present, but are significantly shorter in total presentation, because changed items are shown as changes (“!”) instead of potentially “mismatched” pairs of additions and deletions.</p>

<p>The result of this operation is similar to that of Diff::LCS::SDiffCallbacks. They may be compared as:</p>

<pre><code>s = Diff::LCS.sdiff(seq1, seq2).reject { |e| e.action == &quot;=&quot; }
c = Diff::LCS.sdiff(seq1, seq2, Diff::LCS::ContextDiffCallbacks).flatten

s == c # -&gt; true
</code></pre>

<h3 id="class-LCS::ContextDiffCallbacks-label-Use">Use</h3>

<p>This callback object must be initialised and can be used by the <a href="../LCS.html#method-i-diff"><code>Diff::LCS#diff</code></a> or <a href="../LCS.html#method-i-sdiff"><code>Diff::LCS#sdiff</code></a> methods.</p>

<pre><code>cbo = Diff::LCS::ContextDiffCallbacks.new
Diff::LCS.LCS(seq1, seq2, cbo)
cbo.finish
</code></pre>

<p>Note that the call to finish is absolutely necessary, or the last set of changes will not be visible. Alternatively, can be used as:</p>

<pre><code>cbo = Diff::LCS::ContextDiffCallbacks.new { |tcbo| Diff::LCS.LCS(seq1, seq2, tcbo) }
</code></pre>

<p>The necessary finish call will be made.</p>

<h3 id="class-LCS::ContextDiffCallbacks-label-Simplified+Array+Format">Simplified <a href="../Array.html"><code>Array</code></a> Format</h3>

<p>The simplified array format used in the example above can be obtained with:</p>

<pre><code>require &#39;pp&#39;
pp diffs.map { |e| e.map { |f| f.to_a } }
</code></pre>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-change">change</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-discard_a">discard_a</a>,
              </li>
            
              
              <li>
                <a href="#method-i-discard_b">discard_b</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
    
    
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-change">
            
              <b>change</b>(event)
            
            <a href="../../classes/LCS/ContextDiffCallbacks.html#method-i-change" name="method-i-change" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-change_source')" id="l_method-i-change_source">show</a>
                
              </p>
              <div id="method-i-change_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/diff-lcs-1.3/lib/diff/lcs/callbacks.rb, line 228</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">change</span>(<span class="ruby-identifier">event</span>)
  <span class="ruby-ivar">@hunk</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Diff</span><span class="ruby-operator">::</span><span class="ruby-constant">LCS</span><span class="ruby-operator">::</span><span class="ruby-constant">ContextChange</span>.<span class="ruby-identifier">simplify</span>(<span class="ruby-identifier">event</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-discard_a">
            
              <b>discard_a</b>(event)
            
            <a href="../../classes/LCS/ContextDiffCallbacks.html#method-i-discard_a" name="method-i-discard_a" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-discard_a_source')" id="l_method-i-discard_a_source">show</a>
                
              </p>
              <div id="method-i-discard_a_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/diff-lcs-1.3/lib/diff/lcs/callbacks.rb, line 220</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">discard_a</span>(<span class="ruby-identifier">event</span>)
  <span class="ruby-ivar">@hunk</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Diff</span><span class="ruby-operator">::</span><span class="ruby-constant">LCS</span><span class="ruby-operator">::</span><span class="ruby-constant">ContextChange</span>.<span class="ruby-identifier">simplify</span>(<span class="ruby-identifier">event</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-discard_b">
            
              <b>discard_b</b>(event)
            
            <a href="../../classes/LCS/ContextDiffCallbacks.html#method-i-discard_b" name="method-i-discard_b" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-discard_b_source')" id="l_method-i-discard_b_source">show</a>
                
              </p>
              <div id="method-i-discard_b_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/diff-lcs-1.3/lib/diff/lcs/callbacks.rb, line 224</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">discard_b</span>(<span class="ruby-identifier">event</span>)
  <span class="ruby-ivar">@hunk</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Diff</span><span class="ruby-operator">::</span><span class="ruby-constant">LCS</span><span class="ruby-operator">::</span><span class="ruby-constant">ContextChange</span>.<span class="ruby-identifier">simplify</span>(<span class="ruby-identifier">event</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
  
</div>

    </div>
  </body>
</html>
