<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>FileUtils</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="FileUtils">

  

    <meta name="keywords" content="FileUtils class">
  
    <meta name="keywords" content="sh, ruby, safe_ln, split_all">
  
</head>

<body>
    <div class="banner">
        
        <h1>
            <span class="type">Module</span>
            FileUtils
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/vendor/bundle/ruby/2_6_0/gems/rake-10_5_0/lib/rake/file_utils_rb.html">vendor/bundle/ruby/2.6.0/gems/rake-10.5.0/lib/rake/file_utils.rb</a></li>
            
            <li><a href="../files/vendor/bundle/ruby/2_6_0/gems/rake-10_5_0/test/test_rake_file_utils_rb.html">vendor/bundle/ruby/2.6.0/gems/rake-10.5.0/test/test_rake_file_utils.rb</a></li>
            
            <li><a href="../files/vendor/bundle/ruby/2_6_0/gems/rspec-support-3_8_0/lib/rspec/support/spec/shell_out_rb.html">vendor/bundle/ruby/2.6.0/gems/rspec-support-3.8.0/lib/rspec/support/spec/shell_out.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-ruby">ruby</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-safe_ln">safe_ln</a>,
              </li>
            
              
              <li>
                <a href="#method-i-sh">sh</a>,
              </li>
            
              
              <li>
                <a href="#method-i-split_all">split_all</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    
      <!-- Section constants -->
      <div class="sectiontitle">Constants</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">RUBY</td>
            <td>=</td>
            <td class="attr-value">ENV[&#39;RUBY&#39;] || File.join(
RbConfig::CONFIG[&#39;bindir&#39;],
RbConfig::CONFIG[&#39;ruby_install_name&#39;] + RbConfig::CONFIG[&#39;EXEEXT&#39;]).
sub(/.*\s.*/m, &#39;&quot;\&amp;&quot;&#39;)</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"><p>Path to the currently running Ruby program</p></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">LN_SUPPORTED</td>
            <td>=</td>
            <td class="attr-value">[true]</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
      </table>
    


    


    <!-- Methods -->
    
    
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-ruby">
            
              <b>ruby</b>(*args, &amp;block)
            
            <a href="../classes/FileUtils.html#method-i-ruby" name="method-i-ruby" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Run a Ruby interpreter with the given arguments.</p>

<p>Example:</p>

<pre><code>ruby %{-pe &#39;$_.upcase!&#39; &lt;README}
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-ruby_source')" id="l_method-i-ruby_source">show</a>
                
              </p>
              <div id="method-i-ruby_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rake-10.5.0/lib/rake/file_utils.rb, line 91</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">ruby</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">options</span> = (<span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">:</span> {}
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">sh</span>(<span class="ruby-operator">*</span>([<span class="ruby-constant">RUBY</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">args</span> <span class="ruby-operator">+</span> [<span class="ruby-identifier">options</span>]), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">sh</span>(<span class="ruby-node">&quot;#{RUBY} #{args.first}&quot;</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-safe_ln">
            
              <b>safe_ln</b>(*args)
            
            <a href="../classes/FileUtils.html#method-i-safe_ln" name="method-i-safe_ln" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Attempt to do a normal file link, but fall back to a copy if the link fails.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-safe_ln_source')" id="l_method-i-safe_ln_source">show</a>
                
              </p>
              <div id="method-i-safe_ln_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rake-10.5.0/lib/rake/file_utils.rb, line 104</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">safe_ln</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-constant">LN_SUPPORTED</span>[<span class="ruby-value">0</span>]
    <span class="ruby-identifier">cp</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">ln</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span>, <span class="ruby-constant">NotImplementedError</span>
      <span class="ruby-constant">LN_SUPPORTED</span>[<span class="ruby-value">0</span>] = <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">cp</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-sh">
            
              <b>sh</b>(*cmd, &amp;block)
            
            <a href="../classes/FileUtils.html#method-i-sh" name="method-i-sh" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Run the system command <code>cmd</code>.  If multiple arguments are given the command is run directly (without the shell, same semantics as Kernel::exec and Kernel::system).</p>

<p>It is recommended you use the multiple argument form over interpolating user input for both usability and security reasons.  With the multiple argument form you can easily process files with spaces or other shell reserved characters in them.  With the multiple argument form your rake tasks are not vulnerable to users providing an argument like <code>; rm # -rf /</code>.</p>

<p>If a block is given, upon command completion the block is called with an OK flag (true on a zero exit status) and a Process::Status object. Without a block a RuntimeError is raised when the command exits non-zero.</p>

<p>Examples:</p>

<pre><code>sh &#39;ls -ltr&#39;

sh &#39;ls&#39;, &#39;file with spaces&#39;

# check exit status after command runs
sh %{grep pattern file} do |ok, res|
  if ! ok
    puts &quot;pattern not found (status = #{res.exitstatus})&quot;
  end
end
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-sh_source')" id="l_method-i-sh_source">show</a>
                
              </p>
              <div id="method-i-sh_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rake-10.5.0/lib/rake/file_utils.rb, line 45</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sh</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">options</span> = (<span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">last</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">:</span> {}
  <span class="ruby-identifier">shell_runner</span> = <span class="ruby-identifier">block_given?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">block</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">create_shell_runner</span>(<span class="ruby-identifier">cmd</span>)
  <span class="ruby-identifier">set_verbose_option</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:noop</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Rake</span><span class="ruby-operator">::</span><span class="ruby-constant">FileUtilsExt</span>.<span class="ruby-identifier">nowrite_flag</span>
  <span class="ruby-constant">Rake</span>.<span class="ruby-identifier">rake_check_options</span> <span class="ruby-identifier">options</span>, <span class="ruby-value">:noop</span>, <span class="ruby-value">:verbose</span>
  <span class="ruby-constant">Rake</span>.<span class="ruby-identifier">rake_output_message</span> <span class="ruby-identifier">cmd</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:verbose</span>]

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:noop</span>]
    <span class="ruby-identifier">res</span> = <span class="ruby-identifier">rake_system</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cmd</span>)
    <span class="ruby-identifier">status</span> = <span class="ruby-identifier">$?</span>
    <span class="ruby-identifier">status</span> = <span class="ruby-constant">Rake</span><span class="ruby-operator">::</span><span class="ruby-constant">PseudoStatus</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">1</span>) <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">res</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">status</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">shell_runner</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">res</span>, <span class="ruby-identifier">status</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-split_all">
            
              <b>split_all</b>(path)
            
            <a href="../classes/FileUtils.html#method-i-split_all" name="method-i-split_all" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Split a file path into individual directory names.</p>

<p>Example:</p>

<pre><code>split_all(&quot;a/b/c&quot;) =&gt;  [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-split_all_source')" id="l_method-i-split_all_source">show</a>
                
              </p>
              <div id="method-i-split_all_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rake-10.5.0/lib/rake/file_utils.rb, line 122</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">split_all</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">head</span>, <span class="ruby-identifier">tail</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">split</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-keyword">return</span> [<span class="ruby-identifier">tail</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">head</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;.&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">tail</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;/&#39;</span>
  <span class="ruby-keyword">return</span> [<span class="ruby-identifier">head</span>, <span class="ruby-identifier">tail</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">head</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;/&#39;</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">split_all</span>(<span class="ruby-identifier">head</span>) <span class="ruby-operator">+</span> [<span class="ruby-identifier">tail</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
  
</div>

    </div>
  </body>
</html>
