<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>RDoc::Markup::PreProcess</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/github.css" type="text/css" media="screen" />
<script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="RDoc::Markup::PreProcess">

  
    
    <meta name="description" content="Handle common directives that can occur in a block of text:  :include: filename   Directives can be escaped by preceding them with a backslash.">
    <meta property="og:description" content="Handle common directives that can occur in a block of text:  :include: filename   Directives can be escaped by preceding them with a backslash.">
  

    <meta name="keywords" content="RDoc::Markup::PreProcess class">
  
    <meta name="keywords" content="post_process, post_processors, register, registered, reset, new, handle, handle_directive, include_file, find_include_file">
  
</head>

<body>
    <div class="banner">
        
        <h1>
            <span class="type">Class</span>
            RDoc::Markup::PreProcess
            
                <span class="parent">&lt;
                    
                    <a href="../../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/vendor/bundle/ruby/2_6_0/gems/rdoc-6_1_1/lib/rdoc/markup/pre_process_rb.html">vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>Handle common directives that can occur in a block of text:</p>

<pre><code>:include: filename
</code></pre>

<p>Directives can be escaped by preceding them with a backslash.</p>

<p><a href="../../RDoc.html"><code>RDoc</code></a> plugin authors can register additional directives to be handled by using <a href="PreProcess.html#method-c-register"><code>RDoc::Markup::PreProcess::register</code></a>.</p>

<p>Any directive that is not built-in to <a href="../../RDoc.html"><code>RDoc</code></a> (including those registered via plugins) will be stored in the metadata hash on the CodeObject the comment is attached to.  See <a href="../Markup.html#label-Directives">Directives at <code>RDoc::Markup</code></a> for the list of built-in directives.</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>F</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-find_include_file">find_include_file</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>H</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-handle">handle</a>,
              </li>
            
              
              <li>
                <a href="#method-i-handle_directive">handle_directive</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-include_file">include_file</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>P</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-post_process">post_process</a>,
              </li>
            
              
              <li>
                <a href="#method-c-post_processors">post_processors</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-register">register</a>,
              </li>
            
              
              <li>
                <a href="#method-c-registered">registered</a>,
              </li>
            
              
              <li>
                <a href="#method-c-reset">reset</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'><p>An <a href="../Options.html"><code>RDoc::Options</code></a> instance that will be filled in with overrides from directives</p></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <b>new</b>(input_file_name, include_path)
            
            <a href="../../../classes/RDoc/Markup/PreProcess.html#method-c-new" name="method-c-new" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Creates a new pre-processor for <code>input_file_name</code> that will look for included files in <code>include_path</code></p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">input_file_name</span>, <span class="ruby-identifier">include_path</span>)
  <span class="ruby-ivar">@input_file_name</span> = <span class="ruby-identifier">input_file_name</span>
  <span class="ruby-ivar">@include_path</span> = <span class="ruby-identifier">include_path</span>
  <span class="ruby-ivar">@options</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-post_process">
            
              <b>post_process</b>(&amp;block)
            
            <a href="../../../classes/RDoc/Markup/PreProcess.html#method-c-post_process" name="method-c-post_process" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Adds a post-process handler for directives.  The handler will be called with the result <a href="../Comment.html"><code>RDoc::Comment</code></a> (or text <a href="../../String.html"><code>String</code></a>) and the code object for the comment (if any).</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-post_process_source')" id="l_method-c-post_process_source">show</a>
                
              </p>
              <div id="method-c-post_process_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb, line 30</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">post_process</span> <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-ivar">@post_processors</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-post_processors">
            
              <b>post_processors</b>()
            
            <a href="../../../classes/RDoc/Markup/PreProcess.html#method-c-post_processors" name="method-c-post_processors" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Registered post-processors</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-post_processors_source')" id="l_method-c-post_processors_source">show</a>
                
              </p>
              <div id="method-c-post_processors_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb, line 37</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">post_processors</span>
  <span class="ruby-ivar">@post_processors</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-register">
            
              <b>register</b>(directive, &amp;block)
            
            <a href="../../../classes/RDoc/Markup/PreProcess.html#method-c-register" name="method-c-register" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Registers <code>directive</code> as one handled by <a href="../../RDoc.html"><code>RDoc</code></a>.  If a block is given the directive will be replaced by the result of the block, otherwise the directive will be removed from the processed text.</p>

<p>The block will be called with the directive name and the directive parameter:</p>

<pre><code>RDoc::Markup::PreProcess.register &#39;my-directive&#39; do |directive, param|
  # replace text, etc.
end
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-register_source')" id="l_method-c-register_source">show</a>
                
              </p>
              <div id="method-c-register_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb, line 53</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">register</span> <span class="ruby-identifier">directive</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-ivar">@registered</span>[<span class="ruby-identifier">directive</span>] = <span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-registered">
            
              <b>registered</b>()
            
            <a href="../../../classes/RDoc/Markup/PreProcess.html#method-c-registered" name="method-c-registered" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Registered directives</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-registered_source')" id="l_method-c-registered_source">show</a>
                
              </p>
              <div id="method-c-registered_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">registered</span>
  <span class="ruby-ivar">@registered</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-reset">
            
              <b>reset</b>()
            
            <a href="../../../classes/RDoc/Markup/PreProcess.html#method-c-reset" name="method-c-reset" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Clears all registered directives and post-processors</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-reset_source')" id="l_method-c-reset_source">show</a>
                
              </p>
              <div id="method-c-reset_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb, line 67</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">reset</span>
  <span class="ruby-ivar">@post_processors</span> = []
  <span class="ruby-ivar">@registered</span> = {}
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-find_include_file">
            
              <b>find_include_file</b>(name)
            
            <a href="../../../classes/RDoc/Markup/PreProcess.html#method-i-find_include_file" name="method-i-find_include_file" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Look for the given file in the directory containing the current file, and then in each of the directories specified in the RDOC_INCLUDE path</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-find_include_file_source')" id="l_method-i-find_include_file_source">show</a>
                
              </p>
              <div id="method-i-find_include_file_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb, line 286</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">find_include_file</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">to_search</span> = [<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-ivar">@input_file_name</span>)].<span class="ruby-identifier">concat</span> <span class="ruby-ivar">@include_path</span>
  <span class="ruby-identifier">to_search</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">full_name</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">name</span>)
    <span class="ruby-identifier">stat</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">full_name</span>) <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">full_name</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">readable?</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-handle">
            
              <b>handle</b>(text, code_object = nil, &amp;block)
            
            <a href="../../../classes/RDoc/Markup/PreProcess.html#method-i-handle" name="method-i-handle" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Look for directives in the given <code>text</code>.</p>

<p>Options that we don&#39;t handle are yielded.  If the block returns false the directive is restored to the text.  If the block returns nil or no block was given the directive is handled according to the registered directives. If a <a href="../../String.html"><code>String</code></a> was returned the directive is replaced with the string.</p>

<p>If no matching directive was registered the directive is restored to the text.</p>

<p>If <code>code_object</code> is given and the directive is unknown then the directive&#39;s parameter is set as metadata on the <code>code_object</code>.  See <a href="../CodeObject.html#attribute-i-metadata"><code>RDoc::CodeObject#metadata</code></a> for details.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-handle_source')" id="l_method-i-handle_source">show</a>
                
              </p>
              <div id="method-i-handle_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle</span> <span class="ruby-identifier">text</span>, <span class="ruby-identifier">code_object</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Comment</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">text</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">comment</span> = <span class="ruby-identifier">text</span>
    <span class="ruby-identifier">text</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">text</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># regexp helper (square brackets for optional)</span>
  <span class="ruby-comment"># $1      $2  $3        $4      $5</span>
  <span class="ruby-comment"># [prefix][\]:directive:[spaces][param]newline</span>
  <span class="ruby-identifier">text</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^([ \t]*(?:#|\/?\*)?[ \t]*)(\\?):(\w+):([ \t]*)(.+)?(\r?\n|$)/</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># skip something like &#39;:toto::&#39;</span>
    <span class="ruby-keyword">next</span> <span class="ruby-node">$&amp;</span> <span class="ruby-keyword">if</span> <span class="ruby-node">$4</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword">and</span> <span class="ruby-node">$5</span> <span class="ruby-keyword">and</span> <span class="ruby-node">$5</span>[<span class="ruby-value">0</span>, <span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;:&#39;</span>

    <span class="ruby-comment"># skip if escaped</span>
    <span class="ruby-keyword">next</span> <span class="ruby-string">&quot;#$1:#$3:#$4#$5\n&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-node">$2</span>.<span class="ruby-identifier">empty?</span>

    <span class="ruby-comment"># This is not in handle_directive because I didn&#39;t want to pass another</span>
    <span class="ruby-comment"># argument into it</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">comment</span> <span class="ruby-keyword">and</span> <span class="ruby-node">$3</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;markup&#39;</span> <span class="ruby-keyword">then</span>
      <span class="ruby-keyword">next</span> <span class="ruby-node">&quot;#{$1.strip}\n&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-node">$5</span>
      <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">format</span> = <span class="ruby-node">$5</span>.<span class="ruby-identifier">downcase</span>
      <span class="ruby-keyword">next</span> <span class="ruby-node">&quot;#{$1.strip}\n&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">handle_directive</span> <span class="ruby-node">$1</span>, <span class="ruby-node">$3</span>, <span class="ruby-node">$5</span>, <span class="ruby-identifier">code_object</span>, <span class="ruby-identifier">text</span>.<span class="ruby-identifier">encoding</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">comment</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">text</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">comment</span> = <span class="ruby-identifier">text</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">post_processors</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">handler</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">handler</span>.<span class="ruby-identifier">call</span> <span class="ruby-identifier">comment</span>, <span class="ruby-identifier">code_object</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">text</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-handle_directive">
            
              <b>handle_directive</b>(prefix, directive, param, code_object = nil, encoding = nil)
            
            <a href="../../../classes/RDoc/Markup/PreProcess.html#method-i-handle_directive" name="method-i-handle_directive" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Performs the actions described by <code>directive</code> and its parameter <code>param</code>.</p>

<p><code>code_object</code> is used for directives that operate on a class or module. <code>prefix</code> is used to ensure the replacement for handled directives is correct.  <code>encoding</code> is used for the <code>include</code> directive.</p>

<p>For a list of directives in <a href="../../RDoc.html"><code>RDoc</code></a> see <a href="../Markup.html"><code>RDoc::Markup</code></a>.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-handle_directive_source')" id="l_method-i-handle_directive_source">show</a>
                
              </p>
              <div id="method-i-handle_directive_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb, line 150</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_directive</span> <span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">directive</span>, <span class="ruby-identifier">param</span>, <span class="ruby-identifier">code_object</span> = <span class="ruby-keyword">nil</span>,
                     <span class="ruby-identifier">encoding</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">blankline</span> = <span class="ruby-node">&quot;#{prefix.strip}\n&quot;</span>
  <span class="ruby-identifier">directive</span> = <span class="ruby-identifier">directive</span>.<span class="ruby-identifier">downcase</span>

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">directive</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;arg&#39;</span>, <span class="ruby-string">&#39;args&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-node">&quot;#{prefix}:#{directive}: #{param}\n&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">AnyMethod</span>)

    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span> = <span class="ruby-identifier">param</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;category&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Context</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">code_object</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">section</span> = <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">add_section</span> <span class="ruby-identifier">param</span>
      <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">temporary_section</span> = <span class="ruby-identifier">section</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">blankline</span> <span class="ruby-comment"># ignore category if we&#39;re not on an RDoc::Context</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;doc&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_self</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">force_documentation</span> = <span class="ruby-keyword">true</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;enddoc&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">done_documenting</span> = <span class="ruby-keyword">true</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;include&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">param</span>.<span class="ruby-identifier">split</span>.<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">include_file</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">encoding</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;main&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">main_page</span> = <span class="ruby-identifier">param</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:main_page</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;nodoc&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_self</span> = <span class="ruby-keyword">nil</span> <span class="ruby-comment"># notify nodoc</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_children</span> = <span class="ruby-identifier">param</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp">/all/i</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;notnew&#39;</span>, <span class="ruby-string">&#39;not_new&#39;</span>, <span class="ruby-string">&#39;not-new&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">AnyMethod</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">code_object</span>

    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">dont_rename_initialize</span> = <span class="ruby-keyword">true</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;startdoc&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>

    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">start_doc</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">force_documentation</span> = <span class="ruby-keyword">true</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;stopdoc&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>

    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">stop_doc</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;title&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">default_title</span> = <span class="ruby-identifier">param</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:default_title=</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;yield&#39;</span>, <span class="ruby-string">&#39;yields&#39;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>
    <span class="ruby-comment"># remove parameter &amp;block</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span> = <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/,?\s*&amp;\w+/</span>, <span class="ruby-string">&#39;&#39;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span>

    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">block_params</span> = <span class="ruby-identifier">param</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">result</span> = <span class="ruby-keyword">yield</span> <span class="ruby-identifier">directive</span>, <span class="ruby-identifier">param</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>

    <span class="ruby-keyword">case</span> <span class="ruby-identifier">result</span>
    <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">metadata</span>[<span class="ruby-identifier">directive</span>] = <span class="ruby-identifier">param</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">code_object</span>

      <span class="ruby-keyword">if</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Markup</span><span class="ruby-operator">::</span><span class="ruby-constant">PreProcess</span>.<span class="ruby-identifier">registered</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">directive</span> <span class="ruby-keyword">then</span>
        <span class="ruby-identifier">handler</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Markup</span><span class="ruby-operator">::</span><span class="ruby-constant">PreProcess</span>.<span class="ruby-identifier">registered</span>[<span class="ruby-identifier">directive</span>]
        <span class="ruby-identifier">result</span> = <span class="ruby-identifier">handler</span>.<span class="ruby-identifier">call</span> <span class="ruby-identifier">directive</span>, <span class="ruby-identifier">param</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">handler</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">result</span> = <span class="ruby-node">&quot;#{prefix}:#{directive}: #{param}\n&quot;</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">when</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">result</span> = <span class="ruby-node">&quot;#{prefix}:#{directive}: #{param}\n&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">result</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-include_file">
            
              <b>include_file</b>(name, indent, encoding)
            
            <a href="../../../classes/RDoc/Markup/PreProcess.html#method-i-include_file" name="method-i-include_file" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Handles the <code>:include: <em>filename</em></code> directive.</p>

<p>If the first line of the included file starts with &#39;#&#39;, and contains an encoding information in the form &#39;coding:&#39; or &#39;coding=&#39;, it is removed.</p>

<p>If all lines in the included file start with a &#39;#&#39;, this leading &#39;#&#39; is removed before inclusion. The included content is indented like the <code>:include:</code> directive.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-include_file_source')" id="l_method-i-include_file_source">show</a>
                
              </p>
              <div id="method-i-include_file_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rdoc-6.1.1/lib/rdoc/markup/pre_process.rb, line 260</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">include_file</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">indent</span>, <span class="ruby-identifier">encoding</span>
  <span class="ruby-identifier">full_name</span> = <span class="ruby-identifier">find_include_file</span> <span class="ruby-identifier">name</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">full_name</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;Couldn&#39;t find file to include &#39;#{name}&#39; from #{@input_file_name}&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">content</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">read_file</span> <span class="ruby-identifier">full_name</span>, <span class="ruby-identifier">encoding</span>, <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">content</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">remove_magic_comment</span> <span class="ruby-identifier">content</span>

  <span class="ruby-comment"># strip magic comment</span>
  <span class="ruby-identifier">content</span> = <span class="ruby-identifier">content</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/\A# .*coding[=:].*$/</span>, <span class="ruby-string">&#39;&#39;</span>).<span class="ruby-identifier">lstrip</span>

  <span class="ruby-comment"># strip leading &#39;#&#39;s, but only if all lines start with them</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">content</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^[^#]/</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">content</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^/</span>, <span class="ruby-identifier">indent</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">content</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^#?/</span>, <span class="ruby-identifier">indent</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
  
</div>

    </div>
  </body>
</html>
