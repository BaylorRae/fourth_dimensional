<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>RSpec::Core::Metadata</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/github.css" type="text/css" media="screen" />
<script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="RSpec::Core::Metadata">

  
    
    <meta name="description" content="Each ExampleGroup class and Example instance owns an instance of Metadata, which is Hash extended to support lazy evaluation of values associated with keys that may or may not be used by any example o.">
    <meta property="og:description" content="Each ExampleGroup class and Example instance owns an instance of Metadata, which is Hash extended to support lazy evaluation of values associated with keys that may or may not be used by any example o.">
  

    <meta name="keywords" content="RSpec::Core::Metadata class">
  
    <meta name="keywords" content="relative_path_regex, relative_path, ascending, ascend, build_hash_from, deep_hash_dup, id_from, location_tuple_from">
  
</head>

<body>
    <div class="banner">
        
        <h1>
            <span class="type">Module</span>
            RSpec::Core::Metadata
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/vendor/bundle/ruby/2_6_0/gems/rspec-core-3_8_0/lib/rspec/core/metadata_rb.html">vendor/bundle/ruby/2.6.0/gems/rspec-core-3.8.0/lib/rspec/core/metadata.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>Each <a href="ExampleGroup.html"><code>ExampleGroup</code></a> class and <a href="Example.html"><code>Example</code></a> instance owns an instance of <a href="Metadata.html"><code>Metadata</code></a>, which is Hash extended to support lazy evaluation of values associated with keys that may or may not be used by any example or group.</p>

<p>In addition to metadata that is used internally, this also stores user-supplied metadata, e.g.</p>

<pre><code>describe Something, :type =&gt; :ui do
  it &quot;does something&quot;, :slow =&gt; true do
    # ...
  end
end
</code></pre>

<p>`:type =&gt; :ui` is stored in the <a href="Metadata.html"><code>Metadata</code></a> owned by the example group, and `:slow =&gt; true` is stored in the <a href="Metadata.html"><code>Metadata</code></a> owned by the example. These can then be used to select which examples are run using the `â€“tag` option on the command line, or several methods on `Configuration` used to filter a run (e.g. `filter_run_including`, `filter_run_excluding`, etc).</p>

<p>@see <a href="Example.html#attribute-i-metadata"><code>Example#metadata</code></a> @see <a href="ExampleGroup.html#method-c-metadata"><code>ExampleGroup.metadata</code></a> @see <a href="FilterManager.html"><code>FilterManager</code></a> @see <a href="Configuration.html#method-i-filter_run_including"><code>Configuration#filter_run_including</code></a> @see <a href="Configuration.html#method-i-filter_run_excluding"><code>Configuration#filter_run_excluding</code></a></p>

    </div>
  


  


  
  


  
    <!-- Namespace -->
    <div class="sectiontitle">Namespace</div>
    <ul>
      
        <li>
          <span class="type">CLASS</span>
          <a href="Metadata/ExampleGroupHash.html">RSpec::Core::Metadata::ExampleGroupHash</a>
        </li>
      
        <li>
          <span class="type">CLASS</span>
          <a href="Metadata/ExampleHash.html">RSpec::Core::Metadata::ExampleHash</a>
        </li>
      
        <li>
          <span class="type">CLASS</span>
          <a href="Metadata/HashPopulator.html">RSpec::Core::Metadata::HashPopulator</a>
        </li>
      
    </ul>
  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-ascend">ascend</a>,
              </li>
            
              
              <li>
                <a href="#method-c-ascending">ascending</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-build_hash_from">build_hash_from</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-deep_hash_dup">deep_hash_dup</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-id_from">id_from</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>L</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-location_tuple_from">location_tuple_from</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-relative_path">relative_path</a>,
              </li>
            
              
              <li>
                <a href="#method-c-relative_path_regex">relative_path_regex</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    
      <!-- Section constants -->
      <div class="sectiontitle">Constants</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">RESERVED_KEYS</td>
            <td>=</td>
            <td class="attr-value">[
:description,
:description_args,
:described_class,
:example_group,
:parent_example_group,
:execution_result,
:last_run_status,
:file_path,
:absolute_file_path,
:rerun_file_path,
:full_description,
:line_number,
:location,
:scoped_id,
:block,
:shared_group_inclusion_backtrace
]</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"><p>@private</p></td>
            </tr>
          
        
      </table>
    


    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-ascend">
            
              <b>ascend</b>(metadata)
            
            <a href="../../../classes/RSpec/Core/Metadata.html#method-c-ascend" name="method-c-ascend" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>@private Returns an enumerator that iteratively walks up the given metadata through all example group ancestors, yielding each metadata hash along the way.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-ascend_source')" id="l_method-c-ascend_source">show</a>
                
              </p>
              <div id="method-c-ascend_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rspec-core-3.8.0/lib/rspec/core/metadata.rb, line 71</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">ascend</span>(<span class="ruby-identifier">metadata</span>)
  <span class="ruby-identifier">enum_for</span>(<span class="ruby-value">:ascending</span>, <span class="ruby-identifier">metadata</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-ascending">
            
              <b>ascending</b>(metadata)
            
            <a href="../../../classes/RSpec/Core/Metadata.html#method-c-ascending" name="method-c-ascending" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>@private Iteratively walks up from the given metadata through all example group ancestors, yielding each metadata hash along the way.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-ascending_source')" id="l_method-c-ascending_source">show</a>
                
              </p>
              <div id="method-c-ascending_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rspec-core-3.8.0/lib/rspec/core/metadata.rb, line 58</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">ascending</span>(<span class="ruby-identifier">metadata</span>)
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">metadata</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">group_metadata</span> = <span class="ruby-identifier">metadata</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:example_group</span>) { <span class="ruby-identifier">metadata</span>[<span class="ruby-value">:parent_example_group</span>] })

  <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">group_metadata</span>
    <span class="ruby-keyword">break</span> <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">group_metadata</span> = <span class="ruby-identifier">group_metadata</span>[<span class="ruby-value">:parent_example_group</span>])
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-build_hash_from">
            
              <b>build_hash_from</b>(args, warn_about_example_group_filtering=false)
            
            <a href="../../../classes/RSpec/Core/Metadata.html#method-c-build_hash_from" name="method-c-build_hash_from" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>@private Used internally to build a hash from an args array. Symbols are converted into hash keys with a value of `true`. This is done to support simple tagging using a symbol, rather than needing to do `:symbol =&gt; true`.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-build_hash_from_source')" id="l_method-c-build_hash_from_source">show</a>
                
              </p>
              <div id="method-c-build_hash_from_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rspec-core-3.8.0/lib/rspec/core/metadata.rb, line 80</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">build_hash_from</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">warn_about_example_group_filtering</span>=<span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">:</span> {}

  <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span>] = <span class="ruby-keyword">true</span> <span class="ruby-keyword">while</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">warn_about_example_group_filtering</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-value">:example_group</span>)
    <span class="ruby-constant">RSpec</span>.<span class="ruby-identifier">deprecate</span>(<span class="ruby-string">&quot;Filtering by an `:example_group` subhash&quot;</span>,
                    <span class="ruby-value">:replacement</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;the subhash to filter directly&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">hash</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-deep_hash_dup">
            
              <b>deep_hash_dup</b>(object)
            
            <a href="../../../classes/RSpec/Core/Metadata.html#method-c-deep_hash_dup" name="method-c-deep_hash_dup" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>@private</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-deep_hash_dup_source')" id="l_method-c-deep_hash_dup_source">show</a>
                
              </p>
              <div id="method-c-deep_hash_dup_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rspec-core-3.8.0/lib/rspec/core/metadata.rb, line 94</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">deep_hash_dup</span>(<span class="ruby-identifier">object</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">dup</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">object</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">object</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">Hash</span>  <span class="ruby-operator">===</span> <span class="ruby-identifier">object</span>

  <span class="ruby-identifier">object</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-identifier">object</span>.<span class="ruby-identifier">dup</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">duplicate</span>, (<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
    <span class="ruby-identifier">duplicate</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">deep_hash_dup</span>(<span class="ruby-identifier">value</span>)
    <span class="ruby-identifier">duplicate</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-id_from">
            
              <b>id_from</b>(metadata)
            
            <a href="../../../classes/RSpec/Core/Metadata.html#method-c-id_from" name="method-c-id_from" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>@private</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-id_from_source')" id="l_method-c-id_from_source">show</a>
                
              </p>
              <div id="method-c-id_from_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rspec-core-3.8.0/lib/rspec/core/metadata.rb, line 105</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">id_from</span>(<span class="ruby-identifier">metadata</span>)
  <span class="ruby-node">&quot;#{metadata[:rerun_file_path]}[#{metadata[:scoped_id]}]&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-location_tuple_from">
            
              <b>location_tuple_from</b>(metadata)
            
            <a href="../../../classes/RSpec/Core/Metadata.html#method-c-location_tuple_from" name="method-c-location_tuple_from" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>@private</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-location_tuple_from_source')" id="l_method-c-location_tuple_from_source">show</a>
                
              </p>
              <div id="method-c-location_tuple_from_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rspec-core-3.8.0/lib/rspec/core/metadata.rb, line 110</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">location_tuple_from</span>(<span class="ruby-identifier">metadata</span>)
  [<span class="ruby-identifier">metadata</span>[<span class="ruby-value">:absolute_file_path</span>], <span class="ruby-identifier">metadata</span>[<span class="ruby-value">:line_number</span>]]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-relative_path">
            
              <b>relative_path</b>(line)
            
            <a href="../../../classes/RSpec/Core/Metadata.html#method-c-relative_path" name="method-c-relative_path" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>@api private</p>

<p>@param line [String] current code line @return [String] relative path to line</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-relative_path_source')" id="l_method-c-relative_path_source">show</a>
                
              </p>
              <div id="method-c-relative_path_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rspec-core-3.8.0/lib/rspec/core/metadata.rb, line 44</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">relative_path</span>(<span class="ruby-identifier">line</span>)
  <span class="ruby-identifier">line</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-identifier">relative_path_regex</span>, <span class="ruby-string">&quot;\\1.\\2&quot;</span>.<span class="ruby-identifier">freeze</span>)
  <span class="ruby-identifier">line</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/\A([^:]+:\d+)$/</span>, <span class="ruby-string">&#39;\\1&#39;</span>.<span class="ruby-identifier">freeze</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;-e:1&#39;</span>.<span class="ruby-identifier">freeze</span>
  <span class="ruby-identifier">line</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">SecurityError</span>
  <span class="ruby-comment"># :nocov:</span>
  <span class="ruby-keyword">nil</span>
  <span class="ruby-comment"># :nocov:</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-relative_path_regex">
            
              <b>relative_path_regex</b>()
            
            <a href="../../../classes/RSpec/Core/Metadata.html#method-c-relative_path_regex" name="method-c-relative_path_regex" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Matches strings either at the beginning of the input or prefixed with a whitespace, containing the current path, either postfixed with the separator, or at the end of the string. Match groups are the character before and the character after the string if any.</p>

<p><a href="http://rubular.com/r/fT0gmX6VJX">rubular.com/r/fT0gmX6VJX</a> <a href="http://rubular.com/r/duOrD4i3wb">rubular.com/r/duOrD4i3wb</a> <a href="http://rubular.com/r/sbAMHFrOx1">rubular.com/r/sbAMHFrOx1</a></p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-relative_path_regex_source')" id="l_method-c-relative_path_regex_source">show</a>
                
              </p>
              <div id="method-c-relative_path_regex_source" class="dyn-source">
                <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.6.0/gems/rspec-core-3.8.0/lib/rspec/core/metadata.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">relative_path_regex</span>
  <span class="ruby-ivar">@relative_path_regex</span> <span class="ruby-operator">||=</span> <span class="ruby-regexp">/(\A|\s)#{File.expand_path(&#39;.&#39;)}(#{File::SEPARATOR}|\s|\Z)/</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
    
  
</div>

    </div>
  </body>
</html>
